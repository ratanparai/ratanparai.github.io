<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.10.0">Jekyll</generator><link href="https://www.ratanparai.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://www.ratanparai.com/" rel="alternate" type="text/html" /><updated>2025-08-04T07:53:17+00:00</updated><id>https://www.ratanparai.com/feed.xml</id><title type="html">Ratan Parai</title><subtitle>An open notebook of stranger things that I encounter in my everyday life.</subtitle><author><name>Ratan Sunder Parai</name><email>contact@ratanparai.com</email></author><entry><title type="html">How to limit only one thread for network operation for update cached data</title><link href="https://www.ratanparai.com/dotnet/limit-one-thread-for-network-operation/" rel="alternate" type="text/html" title="How to limit only one thread for network operation for update cached data" /><published>2025-08-02T00:00:00+00:00</published><updated>2025-08-02T00:00:00+00:00</updated><id>https://www.ratanparai.com/dotnet/limit-one-thread-for-network-operation</id><content type="html" xml:base="https://www.ratanparai.com/dotnet/limit-one-thread-for-network-operation/"><![CDATA[<p>Managing concurrent network operations is crucial when updating cached data to avoid race conditions and unnecessary load. In .NET, you can achieve this using the <code class="language-plaintext highlighter-rouge">Interlocked.Exchange</code> method.</p>

<h2 id="how-it-works">How It Works</h2>

<p><code class="language-plaintext highlighter-rouge">Interlocked.Exchange</code> sets a variable to a specified value and returns its original value as an atomic operation. This is useful for synchronizing access between multiple threads.</p>

<p>Consider the following condition:</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="n">Interlocked</span><span class="p">.</span><span class="nf">Exchange</span><span class="p">(</span><span class="k">ref</span> <span class="n">_networkOperationsInProgress</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
</code></pre></div></div>

<p>This checks if <code class="language-plaintext highlighter-rouge">_networkOperationsInProgress</code> changes from <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">1</code>. If true, it means no network operation is running, and the current thread can proceed. If another operation is already in progress, the value remains <code class="language-plaintext highlighter-rouge">1</code>, so the condition is false and the code block does not execute.</p>

<p>After the network operation completes, set the value back to <code class="language-plaintext highlighter-rouge">0</code> to allow future operations:</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Interlocked</span><span class="p">.</span><span class="nf">Exchange</span><span class="p">(</span><span class="k">ref</span> <span class="n">_networkOperationsInProgress</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
</code></pre></div></div>

<p>This pattern is useful for scenarios like reading and updating a Redis cache with a lock before the value expires.</p>

<h2 id="example-code">Example Code</h2>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ValueRefresher</span>
<span class="p">{</span>
    <span class="c1">// To avoid concurrent network operations, this flag is used </span>
    <span class="c1">// to achieve synchronization between multiple threads.</span>
    <span class="k">private</span> <span class="kt">int</span> <span class="n">_networkOperationsInProgress</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">RefreshAsync</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Interlocked</span><span class="p">.</span><span class="nf">Exchange</span><span class="p">(</span><span class="k">ref</span> <span class="n">_networkOperationsInProgress</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">try</span> 
            <span class="p">{</span>
                <span class="c1">//TODO: Refresh value here from network</span>
            <span class="p">}</span>
            <span class="k">finally</span>
            <span class="p">{</span>
                <span class="n">Interlocked</span><span class="p">.</span><span class="nf">Exchange</span><span class="p">(</span>
                    <span class="k">ref</span> <span class="n">_networkOperationsInProgress</span><span class="p">,</span> 
                    <span class="m">0</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="reference">Reference</h2>

<p>Microsoft Corporation. (2025). <a href="https://github.com/Azure/AppConfiguration-DotnetProvider/blob/ae71811ea4a48b5d8a53f8336390ffe5bfc13686/src/Microsoft.Extensions.Configuration.AzureAppConfiguration/AzureAppConfigurationProvider.cs#L211">AzureAppConfigurationProvider.cs</a>. In <em>Azure/AppConfiguration-DotnetProvider</em> (C# source code). GitHub.</p>]]></content><author><name>Ratan Sunder Parai</name><email>contact@ratanparai.com</email></author><category term="dotnet" /><summary type="html"><![CDATA[Learn how to use Interlocked.Exchange to ensure only one thread performs network operations for updating cached data.]]></summary></entry><entry><title type="html">Add request id to all asp.net core MVC REST API response</title><link href="https://www.ratanparai.com/dotnet/add-request-id-to-every-response/" rel="alternate" type="text/html" title="Add request id to all asp.net core MVC REST API response" /><published>2023-01-04T04:11:00+00:00</published><updated>2023-01-04T04:11:00+00:00</updated><id>https://www.ratanparai.com/dotnet/add-request-id-to-every-response</id><content type="html" xml:base="https://www.ratanparai.com/dotnet/add-request-id-to-every-response/"><![CDATA[<p>In REST API, most of the time we only send <strong>request ID</strong> when the calls fails with <code class="language-plaintext highlighter-rouge">4XXX</code> or <code class="language-plaintext highlighter-rouge">5XXX</code> status codes. But it is a good practice to send the <strong>request ID</strong> with every response. This can be useful for debugging issues where successful response doesn’t produce the expected result from the <strong>backend service</strong>.</p>

<p>If you are using asp.net, then we can implement this by using <strong>Filters</strong>. At first create a <code class="language-plaintext highlighter-rouge">ActivityIdHeaderResultFilter.cs</code> file with the content -</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">ActivityIdHeaderResultFilter</span>
    <span class="p">:</span> <span class="n">IResultFilter</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">OnResultExecuting</span><span class="p">(</span><span class="n">ResultExecutingContext</span> <span class="n">context</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">context</span>
            <span class="p">.</span><span class="n">HttpContext</span>
            <span class="p">.</span><span class="n">Response</span>
            <span class="p">.</span><span class="n">Headers</span>
            <span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"X-ActivityId"</span><span class="p">,</span> <span class="n">Activity</span><span class="p">.</span><span class="n">Current</span><span class="p">?.</span><span class="n">Id</span><span class="p">);</span>
        
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">OnResultExecuted</span><span class="p">(</span><span class="n">ResultExecutedContext</span> <span class="n">context</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Now Register the filter in your <code class="language-plaintext highlighter-rouge">program.cs</code> or <code class="language-plaintext highlighter-rouge">startup.cs</code> file -</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">services</span><span class="p">.</span><span class="nf">AddMvcCore</span><span class="p">((</span><span class="n">options</span><span class="p">)</span> <span class="p">=&gt;</span>
    <span class="p">{</span>
        <span class="c1">// existing code omitted for brevity</span>
        <span class="n">options</span><span class="p">.</span><span class="n">Filters</span><span class="p">.</span><span class="n">Add</span><span class="p">&lt;</span><span class="n">ActivityIdHeaderResultFilter</span><span class="p">&gt;();</span>
    <span class="p">});</span>
</code></pre></div></div>

<p>Now in every request the backend service will response with <code class="language-plaintext highlighter-rouge">X-ActivityId</code> header with the <strong>request ID</strong> to the caller.</p>]]></content><author><name>Ratan Sunder Parai</name><email>contact@ratanparai.com</email></author><category term="dotnet" /><category term="dotnet" /><category term="dotnet core" /><category term="asp.net core" /><summary type="html"><![CDATA[In REST API, most of the time we only send request ID when the calls fails with 4XXX or 5XXX status codes. But it is a good practice to send the request ID with every response. This can be useful for debugging issues where successful response doesn’t produce the expected result from the backend service.]]></summary></entry><entry><title type="html">Part one: Getting started with asp.net core MVC</title><link href="https://www.ratanparai.com/microservices/part-1-mvc-application/" rel="alternate" type="text/html" title="Part one: Getting started with asp.net core MVC" /><published>2019-11-27T02:41:00+00:00</published><updated>2019-12-13T06:57:15+00:00</updated><id>https://www.ratanparai.com/microservices/part-1-mvc-application</id><content type="html" xml:base="https://www.ratanparai.com/microservices/part-1-mvc-application/"><![CDATA[<p>This is part one of the tutorial series <a href="/microservices/zero-to-hero-with-dotnet-core-microservice-introduction/">Zero to Hero in Microservices with dotnet core</a>.</p>

<p>Today, we will create a basic ASP.NET Core MVC web application. But before that lets create a github repository for our project</p>

<h2 id="create--clone-github-repository">Create &amp; Clone GitHub repository</h2>
<p>At first lets create a GitHub repository. To create a GitHub repository you can use the new <code class="language-plaintext highlighter-rouge">.new</code> domain <a href="https://repo.new">repo.new</a>. Don’t forget to select <code class="language-plaintext highlighter-rouge">Visual Studio</code> <strong>.gitignore</strong>, because we don’t want to commit <code class="language-plaintext highlighter-rouge">Visual Studio</code> generated build artifacts and user specific configurations into <code class="language-plaintext highlighter-rouge">git</code>.</p>

<p><img width="100%" src="/assets/images/resized/20/create-github-repository.png" data-src="/assets/images/resized/800/create-github-repository.png" alt="" data-srcset="    /assets/images/resized/20/create-github-repository.png 20w,    /assets/images/resized/480/create-github-repository.png 480w,    /assets/images/resized/800/create-github-repository.png 800w,    /assets/images/resized/1400/create-github-repository.png 1400w," class="blur-up lazyautosizes lazyload " /></p>

<p>Then clone the repository into your local machine. Copy the repository remote URL -</p>

<p><img width="100%" src="/assets/images/resized/20/clone-github.png" data-src="/assets/images/resized/800/clone-github.png" alt="" data-srcset="    /assets/images/resized/20/clone-github.png 20w,    /assets/images/resized/480/clone-github.png 480w,    /assets/images/resized/800/clone-github.png 800w,    /assets/images/resized/1400/clone-github.png 1400w," class="blur-up lazyautosizes lazyload " /></p>

<p>and then run the command -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone &lt;your repository URL&gt;
</code></pre></div></div>

<p>For my repository, the command is -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:ratanparai/eCommerce-microservices-tutorial.git
</code></pre></div></div>

<h2 id="setup-initial-project-structure">Setup initial project structure</h2>

<p>Open the locally cloned repository folder in <code class="language-plaintext highlighter-rouge">VSCode</code> and open the <code class="language-plaintext highlighter-rouge">VSCode</code> (Check <a href="https://code.visualstudio.com/docs/editor/integrated-terminal">VSCode Integrated Terminal</a> for more info) terminal window. The rest of today’s tutorial we will use the <code class="language-plaintext highlighter-rouge">VSCode</code> terminal and <code class="language-plaintext highlighter-rouge">dotnet</code> command line to tool to setup the initial structure and projects.</p>

<p>You should see similar to this window-</p>

<p><img width="100%" src="/assets/images/resized/20/visual-studio.png" data-src="/assets/images/resized/800/visual-studio.png" alt="" data-srcset="    /assets/images/resized/20/visual-studio.png 20w,    /assets/images/resized/480/visual-studio.png 480w,    /assets/images/resized/800/visual-studio.png 800w,    /assets/images/resized/1400/visual-studio.png 1400w," class="blur-up lazyautosizes lazyload " /></p>

<h3 id="create-globaljson-file">Create global.json file</h3>

<p>Global.json file is used to select the correct .NET Core SDK version to build and run .NET Core application if you have multiple SDK version. You can see the list of installed SKDs in your machine by running -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet <span class="nt">--list-sdks</span>
</code></pre></div></div>

<p>To work on .NET Core v 3.1, lets create a global.json file by running -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet new globaljson <span class="nt">--sdk-version</span> 3.1.100
</code></pre></div></div>

<p>This also throw error if anyone try to build the code but do not have the specified version of SKD installed. It ensure the use of right SDK version.</p>

<h3 id="create-solution-file">Create solution file</h3>

<p>A solution is a structure for organizing projects in Visual Studio. Solution file itself doesn’t do anything special. Although, you can build, run and deploy <code class="language-plaintext highlighter-rouge">.NET Core</code> application without the solution file, but having one make your projects much organized and easy to maintain. We will only have one project at the beginning of this tutorial series, we will create and add more projects to the solution as we progress.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet new sln
</code></pre></div></div>

<h3 id="create-project">Create Project</h3>

<p>Create folder for the project. This command will create three folders with the structure <code class="language-plaintext highlighter-rouge">src&gt;Web&gt;WebMVC</code> -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> src/Web/WebMVC
</code></pre></div></div>

<p>Now create the <code class="language-plaintext highlighter-rouge">mvc</code> project -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet new mvc <span class="nt">--no-https</span> <span class="nt">-o</span> src/Web/WebMVC
</code></pre></div></div>

<p>Here, <code class="language-plaintext highlighter-rouge">--no-https</code> tell the dotnet cli to generate scaffolding code without the <strong>https</strong> support so our web application will only be served in <code class="language-plaintext highlighter-rouge">http</code>. This will make our life easier to create and run our application from <strong>Docker</strong> container later.  And the <code class="language-plaintext highlighter-rouge">-o src/Web/WebMVC</code> argument set the output directory to <code class="language-plaintext highlighter-rouge">src&gt;Web&gt;WebMVC</code>.</p>

<p>Now lets add the project to the solution -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet sln add src/Web/WebMVC
</code></pre></div></div>

<h3 id="run-the-mvc-application">Run the MVC Application</h3>

<p>To configure <code class="language-plaintext highlighter-rouge">VSCode</code> to run the application, go to debug tab and click the setting icon marked in the screenshot bellow, then select <code class="language-plaintext highlighter-rouge">.NET Core</code>. Now you can run the application in <strong>debug</strong> mode by clicking the <strong>run</strong> button on pressing <kbd>F5</kbd> in your keyboard.</p>

<p><img width="100%" src="/assets/images/resized/20/vscode-debug-configure.png" data-src="/assets/images/resized/800/vscode-debug-configure.png" alt="" data-srcset="    /assets/images/resized/20/vscode-debug-configure.png 20w,    /assets/images/resized/480/vscode-debug-configure.png 480w,    /assets/images/resized/800/vscode-debug-configure.png 800w,    /assets/images/resized/1400/vscode-debug-configure.png 1400w," class="blur-up lazyautosizes lazyload " /></p>

<p>After running application, you should see a webpage with the content similar to this -</p>

<p><img width="100%" src="/assets/images/resized/20/welcome-page.png" data-src="/assets/images/resized/800/welcome-page.png" alt="" data-srcset="    /assets/images/resized/20/welcome-page.png 20w,    /assets/images/resized/480/welcome-page.png 480w,    /assets/images/resized/800/welcome-page.png 800w,    /assets/images/resized/1400/welcome-page.png 1400w," class="blur-up lazyautosizes lazyload " /></p>

<p>Congratulation, you have successfully created a <code class="language-plaintext highlighter-rouge">.NET Core MVC</code> web application. If you want to use <strong>Visual Studio</strong>, you can open the solution file (*.sln. For this tutorial <code class="language-plaintext highlighter-rouge">eCommerce-microservices-tutorial.sln</code> file) in Visual Studio and do the rest of the tutorial in Visual Studio too.</p>

<h2 id="mvc-crud-web-application">MVC CRUD Web Application</h2>
<p>In this part, we will create a MVC application that can <code class="language-plaintext highlighter-rouge">create</code>, <code class="language-plaintext highlighter-rouge">read</code>, <code class="language-plaintext highlighter-rouge">update</code> and <code class="language-plaintext highlighter-rouge">delete</code> data into database. For database, we are going to use <code class="language-plaintext highlighter-rouge">SQLite</code>. <code class="language-plaintext highlighter-rouge">SQLite</code> is a file based lightweight database which doesn’t requires any special tools to be installed on your machine.</p>

<h3 id="create-domain-models">Create Domain Models</h3>

<blockquote>
  <p>A domain model is a conceptual model of the domain that incorporates both behavior and data</p>
</blockquote>

<p>Inside the <code class="language-plaintext highlighter-rouge">Models</code> folder create a new class named <code class="language-plaintext highlighter-rouge">CatalogItem</code> and add some <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/auto-implemented-properties">Auto-Implemented Properties</a>. We will improve this domain model in future tutorials, but for now, lets keep it simple -</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">CatalogItem</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Description</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">decimal</span> <span class="n">Price</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">AvailableStock</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="ef-core-with-sqlite">EF Core with SQLite</h3>

<p><code class="language-plaintext highlighter-rouge">EF Core</code> is a powerful <code class="language-plaintext highlighter-rouge">ORM</code>. Using <code class="language-plaintext highlighter-rouge">ORM</code> we can skip the database specific <code class="language-plaintext highlighter-rouge">query</code> and change our <code class="language-plaintext highlighter-rouge">database</code> provider from <code class="language-plaintext highlighter-rouge">SQLite</code> to <code class="language-plaintext highlighter-rouge">Microsoft SQL Server</code> with almost no changes in our code. To know more about <code class="language-plaintext highlighter-rouge">EF Core</code> please check <a href="https://docs.microsoft.com/en-us/ef/core/">Entity Framework Core
</a>.</p>

<p>Install EF Core by <code class="language-plaintext highlighter-rouge">cd</code> into the <code class="language-plaintext highlighter-rouge">src/Web/WebMVC</code> directory and running -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet add package Microsoft.EntityFrameworkCore.Sqlite
</code></pre></div></div>

<p>Now create a folder named <code class="language-plaintext highlighter-rouge">Infrastructure</code> and inside the folder create a <code class="language-plaintext highlighter-rouge">Class</code> named <code class="language-plaintext highlighter-rouge">CatalogContext</code> with the code -</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">Microsoft.EntityFrameworkCore</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebMVC.Models</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">WebMVC.Infrastructure</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">CatalogContext</span>
        <span class="p">:</span> <span class="n">DbContext</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="nf">CatalogContext</span><span class="p">(</span><span class="n">DbContextOptions</span><span class="p">&lt;</span><span class="n">CatalogContext</span><span class="p">&gt;</span> <span class="n">options</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="n">DbSet</span><span class="p">&lt;</span><span class="n">CatalogItem</span><span class="p">&gt;</span> <span class="n">CatalogItems</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Our DbContext class need to extend the <code class="language-plaintext highlighter-rouge">DbContext</code> class and in <code class="language-plaintext highlighter-rouge">constructor</code> parameter need to pass the instance of <code class="language-plaintext highlighter-rouge">DbContextOptions&lt;{Our_Class_Name}&gt;</code> to the base class.</p>

<p>Now we need to inject our <code class="language-plaintext highlighter-rouge">CatalogContext</code> class in <code class="language-plaintext highlighter-rouge">startup.cs</code> file -</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>

<span class="k">public</span> <span class="k">void</span> <span class="nf">ConfigureServices</span><span class="p">(</span><span class="n">IServiceCollection</span> <span class="n">services</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">services</span><span class="p">.</span><span class="n">AddDbContext</span><span class="p">&lt;</span><span class="n">CatalogContext</span><span class="p">&gt;(</span><span class="n">options</span> <span class="p">=&gt;</span>
    <span class="p">{</span>
        <span class="n">options</span><span class="p">.</span><span class="nf">UseSqlite</span><span class="p">(</span><span class="s">"Data Source=catalog.db"</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="n">services</span><span class="p">.</span><span class="nf">AddControllersWithViews</span><span class="p">();</span>
<span class="p">}</span>

<span class="p">...</span>
</code></pre></div></div>

<p>We also need to add the <code class="language-plaintext highlighter-rouge">catalog.db</code> file to <code class="language-plaintext highlighter-rouge">.gitignore</code> as this file will hold our <em>database</em> and we do not need to commit this file. Please add those two line in your <code class="language-plaintext highlighter-rouge">.gitignore</code> file as bellow -</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Ignoring all user generated DB files</span>
<span class="k">*</span>.db
</code></pre></div></div>

<p>The first line is a comment, so that we understand what we are trying to do here and the second line is telling <code class="language-plaintext highlighter-rouge">git</code> to ignore any file with the file <strong>extension</strong> <code class="language-plaintext highlighter-rouge">.db</code>.</p>

<p class="notice--danger"><strong>Please Note:</strong> To know how dependency injection works in ASP.NET Core please read <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-3.0">Dependency injection in ASP.NET Core</a></p>

<h3 id="scaffolding-controller-with-views">Scaffolding Controller with Views</h3>

<blockquote>
  <p>The term <strong>Scaffolding</strong> is used by many software technologies to mean <em>“quickly generating a basic outline of your software that you can then edit and customize”</em>.</p>
</blockquote>

<p>Now lets scaffold a CRUD controller with view. To add scaffolding support we need to install -</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet add package Microsoft.VisualStudio.Web.CodeGeneration.Design
dotnet add package Microsoft.EntityFrameworkCore.SqlServer
dotnet add package Microsoft.EntityFrameworkCore.Design
</code></pre></div></div>

<p>Please make sure the global scaffolding tool is installed -</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet tool <span class="nb">install</span> <span class="nt">--global</span> dotnet-aspnet-codegenerator
</code></pre></div></div>

<p class="notice--danger"><strong>Please Note:</strong> If you have already installed any of the global tools before, please run <code class="language-plaintext highlighter-rouge">dotnet tool update --global &lt;package-name&gt;</code> instead of <code class="language-plaintext highlighter-rouge">dotnet tool install --global &lt;package-name&gt;</code> to ensure you global tools is up-to-date.</p>

<p>and then run -</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet aspnet-codegenerator controller <span class="nt">-name</span> CatalogController <span class="nt">-m</span> CatalogItem <span class="nt">-dc</span> CatalogContext <span class="nt">--relativeFolderPath</span> Controllers <span class="nt">--useDefaultLayout</span> <span class="nt">--referenceScriptLibraries</span>
</code></pre></div></div>

<p>Here, in <code class="language-plaintext highlighter-rouge">-name</code> argument we need to pass the <code class="language-plaintext highlighter-rouge">Controller</code> name we want to generate, in <code class="language-plaintext highlighter-rouge">-m</code> pass the previously created <code class="language-plaintext highlighter-rouge">Model</code> class name and in <code class="language-plaintext highlighter-rouge">-dc</code> argument pass the name of our <code class="language-plaintext highlighter-rouge">DBContext</code> class name.</p>

<h3 id="database-migrations">Database Migrations</h3>

<p>To run migration, please make sure you have the <code class="language-plaintext highlighter-rouge">dotnet-ef</code> global tool installed. If now then install it by running -</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet tool <span class="nb">install</span> <span class="nt">--global</span> dotnet-ef
</code></pre></div></div>

<p>Now create and apply migration -</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet ef migrations add InitialCreate
dotnet ef database update
</code></pre></div></div>

<h3 id="update-navigation-bar">Update Navigation bar</h3>

<p>And then add the new Controller in Navigation bar. To do this, please modfity the <code class="language-plaintext highlighter-rouge">Views&gt;Shared&gt;_Layout.cshtml</code> file and add another <code class="language-plaintext highlighter-rouge">nav-item</code> like -</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"navbar-collapse collapse d-sm-inline-flex flex-sm-row-reverse"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"navbar-nav flex-grow-1"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"nav-item"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"nav-link text-dark"</span> <span class="na">asp-area=</span><span class="s">""</span> <span class="na">asp-controller=</span><span class="s">"Home"</span> <span class="na">asp-action=</span><span class="s">"Index"</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"nav-item"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"nav-link text-dark"</span> <span class="na">asp-area=</span><span class="s">""</span> <span class="na">asp-controller=</span><span class="s">"Catalog"</span> <span class="na">asp-action=</span><span class="s">"Index"</span><span class="nt">&gt;</span>Catalog<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"nav-item"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"nav-link text-dark"</span> <span class="na">asp-area=</span><span class="s">""</span> <span class="na">asp-controller=</span><span class="s">"Home"</span> <span class="na">asp-action=</span><span class="s">"Privacy"</span><span class="nt">&gt;</span>Privacy<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<h2 id="conclusion">Conclusion</h2>

<p>Now run the application by pressing <kbd>F5</kbd> on <code class="language-plaintext highlighter-rouge">VSCode</code> <em>or</em> running the command <code class="language-plaintext highlighter-rouge">dotnet run</code> from <em>terminal</em>. Then go the Catalog page by clicking Catalog navbar and test our new Catalog <code class="language-plaintext highlighter-rouge">CRUD</code>. In this page, you can create, read, update and delete catalog items! Explore them!</p>

<p>Congratulation, you have successfully created a <code class="language-plaintext highlighter-rouge">ASP.NET Core MVC</code> Web Application. The source code for today’s tutorial can be found in <a href="https://github.com/ratanparai/eCommerce-microservices-tutorial/tree/part-1">GitHub - eCommerce-microservices-tutorial: part-1</a></p>]]></content><author><name>Ratan Sunder Parai</name><email>contact@ratanparai.com</email></author><category term="Microservices" /><category term="microservices" /><category term="dotnet core" /><summary type="html"><![CDATA[This is part one of the tutorial series Zero to Hero in Microservices with dotnet core.]]></summary></entry><entry><title type="html">Zero to Hero in Microservices with dotnet core - Introduction</title><link href="https://www.ratanparai.com/microservices/zero-to-hero-with-dotnet-core-microservice-introduction/" rel="alternate" type="text/html" title="Zero to Hero in Microservices with dotnet core - Introduction" /><published>2019-11-27T02:30:00+00:00</published><updated>2019-12-13T06:24:05+00:00</updated><id>https://www.ratanparai.com/microservices/zero-to-hero-with-dotnet-core-microservice-introduction</id><content type="html" xml:base="https://www.ratanparai.com/microservices/zero-to-hero-with-dotnet-core-microservice-introduction/"><![CDATA[<p>In this series of blog articles, we are going to start from a basic <strong>dotnet core</strong> <code class="language-plaintext highlighter-rouge">MVC</code> application and then improve it to full blown Microservices with state of the art Microservices patterns and practices. To follow this blog service, you will need those tools-</p>

<ol>
  <li><a href="https://visualstudio.microsoft.com/vs/">Visual Studio 2019</a> <strong>v16.4 or later</strong> or <a href="https://visualstudio.microsoft.com/vs/mac/">Visual Studio for Mac</a>, which will make our development process much faster and beginner friendly</li>
  <li><a href="https://code.visualstudio.com">Visual Studio Code</a>, as this is my <em>favorite</em> test editor and I will use it most of the time</li>
  <li><a href="https://dotnet.microsoft.com/download/dotnet-core/3.1">.NET Core SDK 3.1.100</a>, which is the latest <a href="https://en.wikipedia.org/wiki/Long-term_support">LTS</a> version of .NET Core SDK.</li>
  <li><a href="https://docs.docker.com/docker-for-windows/install/">Docker Desktop for Windows</a> or <a href="https://docs.docker.com/docker-for-mac/install/">Docker Desktop for Mac</a>, we are going to use docker to develop, run and deploy our microservices</li>
</ol>

<p>We will build an E-commerce Web Application.</p>

<p>To jump throw the list of articles follow the links bellow -</p>

<ol>
  <li><a href="/microservices/part-1-mvc-application/">Part 1: MVC Application</a></li>
</ol>]]></content><author><name>Ratan Sunder Parai</name><email>contact@ratanparai.com</email></author><category term="Microservices" /><category term="microservices" /><category term="dotnet core" /><summary type="html"><![CDATA[In this series of blog articles, we are going to start from a basic dotnet core MVC application and then improve it to full blown Microservices with state of the art Microservices patterns and practices. To follow this blog service, you will need those tools-]]></summary></entry><entry><title type="html">Functional Testing of ASP.NET core 2.1 MVC Application</title><link href="https://www.ratanparai.com/dotnet/functional-testing-aspnet-core-2.1-mcv/" rel="alternate" type="text/html" title="Functional Testing of ASP.NET core 2.1 MVC Application" /><published>2018-05-22T15:00:00+00:00</published><updated>2018-05-22T15:00:00+00:00</updated><id>https://www.ratanparai.com/dotnet/functional-testing-aspnet-core-2.1-mcv</id><content type="html" xml:base="https://www.ratanparai.com/dotnet/functional-testing-aspnet-core-2.1-mcv/"><![CDATA[<p>In ASP.NET core 2.1, setting up functional testing project got much easier with the release of <a href="https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.Testing">Microsoft.AspNetCore.Mvc.Testing</a> nuget package. In this post we are going to setup a functional test project.</p>

<h2 id="prerequisite">Prerequisite</h2>

<p>To follow this tutorial you should have-</p>

<ol>
  <li><a href="https://www.microsoft.com/net/download/dotnet-core/sdk-2.1.300-rc1">.NET Core 2.1 RC1 SDK</a> and</li>
  <li><a href="https://code.visualstudio.com/">VS Code</a> or <a href="https://www.visualstudio.com/downloads/">Microsoft Visual Studio 2017</a> v15.7 Preview 1 or newer, installed on your system</li>
</ol>

<h2 id="create-test-project">Create test project</h2>
<p>Create a folder and name it <code class="language-plaintext highlighter-rouge">HelloWorld</code>, because why not :stuck_out_tongue_winking_eye:. Open <strong>PowerShell</strong> window inside the folder (<kbd>Shift</kbd> + <code class="language-plaintext highlighter-rouge">right click</code> anywhere inside the folder and select <code class="language-plaintext highlighter-rouge">Open PowerShell window here</code>) and create a solution:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet new sln
</code></pre></div></div>

<p>Now create a basic <strong>MVC</strong> project inside <code class="language-plaintext highlighter-rouge">src</code> directory and <strong>xunit</strong> project inside <code class="language-plaintext highlighter-rouge">tests</code> directory:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet new mvc -o .\src\HelloWorld.Mvc
dotnet new xunit -o .\tests\HelloWorld.FunctionalTests
</code></pre></div></div>

<p>Add those two project to the <strong>solution</strong>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet sln add .\src\HelloWorld.Mvc\HelloWorld.Mvc.csproj
dotnet sln add .\tests\HelloWorld.FunctionalTests\HelloWorld.FunctionalTests.csproj
</code></pre></div></div>

<p>Reference the <strong>MVC</strong> project form the <strong>FunctionalTests</strong> project:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet add .\tests\HelloWorld.FunctionalTests\HelloWorld.FunctionalTests.csproj reference .\src\HelloWorld.Mvc\HelloWorld.Mvc.csproj
</code></pre></div></div>

<h2 id="write-functional-test">Write functional Test</h2>

<p>Add <a href="https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.Testing">Microsoft.AspNetCore.Mvc.Testing</a> to the functional test project:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet add .\tests\HelloWorld.FunctionalTests\HelloWorld.FunctionalTests.csproj package Microsoft.AspNetCore.Mvc.Testing -v 2.1.0-rc1-final
</code></pre></div></div>

<p>Now open the project in <strong>VS Code</strong> or <strong>Visual Studio 2017 15.7 Preview 1 or newer</strong> and create a new class inside <strong>HelloWorld.FunctionalTests</strong> project and name it <code class="language-plaintext highlighter-rouge">HomePageShould.cs</code></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">HelloWorld.Mvc</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.AspNetCore.Mvc.Testing</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Xunit</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">HelloWorld.FunctionalTests</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">HomePageShould</span> <span class="p">:</span> <span class="n">IClassFixture</span><span class="p">&lt;</span><span class="n">WebApplicationFactory</span><span class="p">&lt;</span><span class="n">Startup</span><span class="p">&gt;&gt;</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">_client</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">HomePageShould</span><span class="p">(</span><span class="n">WebApplicationFactory</span><span class="p">&lt;</span><span class="n">Startup</span><span class="p">&gt;</span> <span class="n">factory</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_client</span> <span class="p">=</span> <span class="n">factory</span><span class="p">.</span><span class="nf">CreateClient</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">ReturnHttpStatusCodeOk</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="s">"/"</span><span class="p">);</span>

            <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">OK</span><span class="p">,</span> <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="run-the-test">Run the test</h2>

<p>Now run the <strong>test</strong>. It should fail with the error message</p>

<blockquote>
  <p>Message: System.IO.FileNotFoundException : Could not load file or assembly ‘Microsoft.AspNetCore, Version=2.1.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60’. The system cannot find the file specified.</p>
</blockquote>

<p>To resolve it, add <a href="https://www.nuget.org/packages/Microsoft.AspNetCore.App/">Microsoft.AspNetCore.App</a> nuget package to the <strong>test</strong> project</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet add .\tests\HelloWorld.FunctionalTests\HelloWorld.FunctionalTests.csproj package Microsoft.AspNetCore.App -v 2.1.0-rc1-final
</code></pre></div></div>

<p>Now run the test from <code class="language-plaintext highlighter-rouge">Test</code>&gt;<code class="language-plaintext highlighter-rouge">Run</code>&gt;<code class="language-plaintext highlighter-rouge">All Tests</code> (Visual Studio 2017) or from <strong>PowerShell</strong>-</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet test .\tests\HelloWorld.FunctionalTests\HelloWorld.FunctionalTests.csproj
</code></pre></div></div>

<p>You should see green tick of happiness.</p>]]></content><author><name>Ratan Sunder Parai</name><email>contact@ratanparai.com</email></author><category term="dotnet" /><category term="asp.net core" /><category term="functional testing" /><category term="dotnet core" /><summary type="html"><![CDATA[In ASP.NET core 2.1, setting up functional testing project got much easier with the release of [Microsoft.AspNetCore.Mvc.Testing](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.Testing) nuget package.]]></summary></entry><entry><title type="html">Writing unit tests for C++ with Bazel and GoogleTest</title><link href="https://www.ratanparai.com/c++/writing-unit-tests-with-bazel/" rel="alternate" type="text/html" title="Writing unit tests for C++ with Bazel and GoogleTest" /><published>2018-04-28T21:05:00+00:00</published><updated>2018-04-28T21:05:00+00:00</updated><id>https://www.ratanparai.com/c++/writing-unit-tests-with-bazel</id><content type="html" xml:base="https://www.ratanparai.com/c++/writing-unit-tests-with-bazel/"><![CDATA[<p>For last couple of months I am in love with writing <strong>Unit Tests</strong>. I wasn’t like that. You may say I was adventurous, hardcore and love living dangerous life! But that wasn’t the case, believe me. I was just plain dumb. So how was my life before I started writing <strong>Unit Tests</strong>?</p>

<p>I was so afraid to refactor my codes. There is a high possibility it may break something else in somewhere that I will not be able to detect soon. But eventually when I will do, it will be very hard to trace why it is broken and fix it. Nobody around me told me to write <strong>Unit Tests</strong> and few who did, didn’t even write Unit Tests for themselves! It was like <a href="https://en.wikipedia.org/wiki/Aesop">Aesob</a>’s <a href="https://fablesofaesop.com/the-two-crabs.html">The Two Crabs</a> story I read at my childhood.</p>

<p><img width="100%" src="/assets/images/resized/20/the-two-crab-aesop.jpg" data-src="/" alt="" data-srcset="    /assets/images/resized/20/the-two-crab-aesop.jpg 20w,    /assets/images/resized/480/the-two-crab-aesop.jpg 480w," class="blur-up lazyautosizes lazyload " /></p>

<p>Although I did some <strong>C++</strong> codes in University and attended some <strong>Programming Competition</strong> where I’ve used C++ for writing code, but I never did <strong>Object Oriented Programming</strong> with C++. So few months ago I have started learning C++ in my free time. At first I tried to use <strong>CMAKE</strong> to build. After using it for sometime, I found <strong>Bazel</strong>. It is faster, more organized and modular.</p>

<p>At first lets look at the folder structure-</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>│   gmock.BUILD
│   WORKSPACE
│
├───src
│   ├───lib
│   │       BUILD
│   │       Greeting.cc
│   │       Greeting.h
│   │
│   └───main
│           BUILD
│           main.cc
│
└───tests
        BUILD
        Greeting_test.cc
</code></pre></div></div>

<p>There should be a <code class="language-plaintext highlighter-rouge">WORKSPACE</code> file in the <strong>root</strong> of your source code. It contains <strong>external dependencies</strong>. If you don’t have any external dependencies in your project, your <code class="language-plaintext highlighter-rouge">WORKSPACE</code> file should be empty, But you must have this file.</p>

<p>We are using <strong>GoogleTest</strong> as external dependency. Lets look inside our <code class="language-plaintext highlighter-rouge">WORKSPACE</code> file-</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>new_git_repository(
    name = "googletest",
    build_file = "gmock.BUILD",
    remote = "https://github.com/google/googletest",
    tag = "release-1.8.0",
)
</code></pre></div></div>

<p>Here, the dependency is added as a git repository. As a result, when we build the project, it will download the <strong>git</strong> repository and run the <code class="language-plaintext highlighter-rouge">build_file</code> <strong>gmock.BUILD</strong> to build the <strong>GoogleTest</strong> library, which we will import in our <strong>tests</strong>. The content of the <strong>gmock.BUILD</strong> file is-</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cc_library(
    name = "gtest",
    srcs = [
        "googletest/src/gtest-all.cc",
        "googlemock/src/gmock-all.cc",
    ],
    hdrs = glob([
        "**/*.h",
        "googletest/src/*.cc",
        "googlemock/src/*.cc",
    ]),
    includes = [
        "googlemock",
        "googletest",
        "googletest/include",
        "googlemock/include",
    ],
    linkopts = ["-pthread"],
    visibility = ["//visibility:public"],
)

cc_library(
    name = "gtest_main",
    srcs = ["googlemock/src/gmock_main.cc"],
    linkopts = ["-pthread"],
    visibility = ["//visibility:public"],
    deps = [":gtest"],
)
</code></pre></div></div>

<p>This concludes our initial setup of <strong>GoogleTest</strong> with <strong>Bazel</strong>. Now we need to add <code class="language-plaintext highlighter-rouge">@googletest//:gtest_main</code> as a dependency of our test library, <code class="language-plaintext highlighter-rouge">cc_test</code> and import <code class="language-plaintext highlighter-rouge">gtest/gtest.h</code> to our <strong>unit test</strong> file. Example <strong>BUILD</strong> file <code class="language-plaintext highlighter-rouge">tests</code> -</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cc_test(
    name = "tests",
    srcs = glob(["**/*.cc"]),
    deps = [
        "//src/lib:GreetingLib",
        "@googletest//:gtest_main",
    ],
)
</code></pre></div></div>

<blockquote>
  <p>Here the first dependency is <code class="language-plaintext highlighter-rouge">cc_library</code> dependency, where we have a <code class="language-plaintext highlighter-rouge">Greeting</code> class that have a <strong>public</strong> method, <code class="language-plaintext highlighter-rouge">getGreetingMessage()</code> that return <code class="language-plaintext highlighter-rouge">Hello World!</code>.</p>
</blockquote>

<p>And content of the <code class="language-plaintext highlighter-rouge">greeting_test.cc</code>-</p>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"gtest/gtest.h"</span><span class="cp">
#include</span> <span class="cpf">"src/lib/Greeting.h"</span><span class="cp">
</span>
<span class="n">TEST</span><span class="p">(</span><span class="n">GreetingShould</span><span class="p">,</span> <span class="n">ReturnHelloWorld</span><span class="p">){</span>
    <span class="n">Greeting</span> <span class="o">*</span><span class="n">greet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Greeting</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">actual</span> <span class="o">=</span> <span class="n">greet</span><span class="o">-&gt;</span><span class="n">getGreetingMessage</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">expected</span> <span class="o">=</span> <span class="s">"Hello World!"</span><span class="p">;</span>
    <span class="n">EXPECT_EQ</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">actual</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="building-and-running-unit-tests">Building and Running unit tests</h3>
<p>Building the gradle project is easy. You just need to run-</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bazel build ...
</code></pre></div></div>

<p>to build every <strong>cc_library</strong> and <strong>cc_binary</strong> of the project. And to run all <strong>unit tests</strong> just run-</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bazel <span class="nb">test</span> ...
</code></pre></div></div>

<p>I have created a <strong>git</strong> repository , which you can clone and use as your starting point. Please feel free to <strong>star</strong> it if you think my repository helps you.</p>

<p><a href="https://github.com/ratanparai/cpp-template">CPP-Template</a></p>]]></content><author><name>Ratan Sunder Parai</name><email>contact@ratanparai.com</email></author><category term="C++" /><category term="bazel" /><category term="googletest" /><summary type="html"><![CDATA[On my journey to be a better programmer, I stated to learn C++. This is how I am using bazel to build my project with google test integration.]]></summary></entry><entry><title type="html">Compile TaskWarrior in Ubuntu</title><link href="https://www.ratanparai.com/taskwarrior/compile-taskwarrior-ubuntu/" rel="alternate" type="text/html" title="Compile TaskWarrior in Ubuntu" /><published>2018-04-05T15:50:00+00:00</published><updated>2018-04-05T15:50:00+00:00</updated><id>https://www.ratanparai.com/taskwarrior/compile-taskwarrior-ubuntu</id><content type="html" xml:base="https://www.ratanparai.com/taskwarrior/compile-taskwarrior-ubuntu/"><![CDATA[<p><a href="https://taskwarrior.org/">Taskwarrior</a> is Free and Open Source Software that manages your TODO list from the command line. It is flexible, fast, and unobtrusive. It does its job then gets out of your way.</p>

<p>Although you can install <code class="language-plaintext highlighter-rouge">TaskWarrior</code> from <code class="language-plaintext highlighter-rouge">Ubuntu</code> package manager, but it doesn’t have latest version. So to get the latest version of <code class="language-plaintext highlighter-rouge">TaskWarrior</code>, you have to download source code and compile it.</p>

<p>Install required package in ubuntu</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> build-essential cmake git uuid-dev libgnutls28-dev
</code></pre></div></div>

<p>download taskwarrior archive</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>wget <span class="o">[</span>url_of_latest_task-x.x.x.tar.gz]
</code></pre></div></div>

<p>After installing required packages run those following command to build and install taskwarrior on your machine</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls</span>
<span class="nv">$ </span>task-x.x.x.tar.gz
<span class="nv">$ </span><span class="nb">tar </span>xzvf task-x.x.x.tar.gz
<span class="nv">$ </span><span class="nb">cd </span>task-x.x.x
<span class="nv">$ </span>cmake <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>release <span class="nb">.</span>
...
<span class="nv">$ </span>make
...
<span class="nv">$ </span><span class="nb">sudo </span>make <span class="nb">install</span>
</code></pre></div></div>

<p>Change the <code class="language-plaintext highlighter-rouge">x's</code> with the correct version number from the <a href="https://taskwarrior.org/download/">TaskWarrior Download</a> page.</p>

<p>Now run <code class="language-plaintext highlighter-rouge">Taskwarrior</code> from terminal by the command -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>task
</code></pre></div></div>]]></content><author><name>Ratan Sunder Parai</name><email>contact@ratanparai.com</email></author><category term="Taskwarrior" /><category term="Ubuntu" /><summary type="html"><![CDATA[Although you can install `TaskWarrior` from `Ubuntu` package manager, but it doesn't have latest version. So you have to download source code and compile it.]]></summary></entry><entry><title type="html">Java application with code coverage report using gradle</title><link href="https://www.ratanparai.com/java/java-application-using-gradle-with-code-coverage/" rel="alternate" type="text/html" title="Java application with code coverage report using gradle" /><published>2017-12-13T06:13:00+00:00</published><updated>2017-12-13T06:13:00+00:00</updated><id>https://www.ratanparai.com/java/java-application-using-gradle-with-code-coverage</id><content type="html" xml:base="https://www.ratanparai.com/java/java-application-using-gradle-with-code-coverage/"><![CDATA[<p>Although we can use IDE for creating new java projects, if we use a build tool like <code class="language-plaintext highlighter-rouge">gradle</code> and create the project from ground up then not only we have more control, we can also change between IDEs as we feel the need.</p>
<h2 id="create-new-application">Create new application</h2>

<p>Create new <code class="language-plaintext highlighter-rouge">java-application</code> type <code class="language-plaintext highlighter-rouge">Java</code> project using <code class="language-plaintext highlighter-rouge">gradle</code> -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gradle init <span class="nt">--type</span> java-application
</code></pre></div></div>

<p class="notice--danger"><strong>Please note:</strong> The Build Init plugin is currently <a href="https://docs.gradle.org/current/userguide/feature_lifecycle.html">incubating</a>. Please be aware that the DSL and other configuration may change in later Gradle versions. To know more about gradle supported java projects read <a href="https://docs.gradle.org/current/userguide/build_init_plugin.html">Gradle Build Init plugin</a> documentation.</p>

<p>This command create a <code class="language-plaintext highlighter-rouge">gradle.build</code> file with the contents</p>

<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*
 * This build file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java project to get you started.
 * For more details take a look at the Java Quickstart chapter in the Gradle
 * user guide available at https://docs.gradle.org/4.2.1/userguide/tutorial_java_projects.html
 */</span>

<span class="c1">// Apply the java plugin to add support for Java</span>
<span class="n">apply</span> <span class="nl">plugin:</span> <span class="s1">'java'</span>

<span class="c1">// Apply the application plugin to add support for building an application</span>
<span class="n">apply</span> <span class="nl">plugin:</span> <span class="s1">'application'</span>

<span class="c1">// In this section you declare where to find the dependencies of your project</span>
<span class="k">repositories</span> <span class="o">{</span>
    <span class="c1">// Use jcenter for resolving your dependencies.</span>
    <span class="c1">// You can declare any Maven/Ivy/file repository here.</span>
    <span class="n">jcenter</span><span class="o">()</span>
<span class="o">}</span>

<span class="k">dependencies</span> <span class="o">{</span>
    <span class="c1">// This dependency is found on compile classpath of this component and consumers.</span>
    <span class="n">compile</span> <span class="s1">'com.google.guava:guava:22.0'</span>

    <span class="c1">// Use JUnit test framework</span>
    <span class="n">testCompile</span> <span class="s1">'junit:junit:4.12'</span>
<span class="o">}</span>

<span class="c1">// Define the main class for the application</span>
<span class="n">mainClassName</span> <span class="o">=</span> <span class="s1">'App'</span>
</code></pre></div></div>

<h2 id="gradle-tasks">Gradle tasks</h2>

<p>To check all tasks of the project run -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gradle task <span class="nt">--all</span>
</code></pre></div></div>

<p>You will see list of tasks available for the project and short description about what the task is about. If you want to run any of the task then just run</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gradle &lt;task name&gt;
</code></pre></div></div>

<p>where <code class="language-plaintext highlighter-rouge">&lt;task name&gt;</code> is the task from the previous command. For example If you run -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gradle build
</code></pre></div></div>

<p>then the <code class="language-plaintext highlighter-rouge">distribution</code>(<strong>compressed executable</strong>) file will be found in  <code class="language-plaintext highlighter-rouge">buld&gt;distributions</code> folder. There is <code class="language-plaintext highlighter-rouge">tar</code> and <code class="language-plaintext highlighter-rouge">zip</code> archive. You can extract and use either of them.</p>

<p>You can create new custom tasks or add plugin that have prebuilt task that you can use.</p>

<h2 id="code-coverage-metric">Code Coverage metric</h2>

<p>Code coverage is one of the most important metric for any project. From <a href="https://en.wikipedia.org/wiki/Code_coverage">Wikipedia</a> -</p>

<blockquote>
  <p>In computer science, test coverage is a measure used to describe the degree to which the source code of a program is executed when a particular test suite runs. A program with high test coverage, measured as a percentage, has had more of its source code executed during testing which suggests it has a lower chance of containing undetected software bugs compared to a program with low test coverage.</p>
</blockquote>

<p>We are going to use <code class="language-plaintext highlighter-rouge">JaCoCo</code><sup id="fnref:1"><a href="#fn:1" class="footnote" rel="footnote" role="doc-noteref">1</a></sup> for test coverage. At first we need to add <code class="language-plaintext highlighter-rouge">JaCoCo</code> as <code class="language-plaintext highlighter-rouge">dependencies</code> -</p>

<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">...</span>
<span class="c1">// Apply the jacoco plugin to add support for test coverage</span>
<span class="n">apply</span> <span class="nl">plugin:</span> <span class="s1">'jacoco'</span>
<span class="o">...</span>
</code></pre></div></div>

<p>Now if we run -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gradle task <span class="nt">--all</span>
</code></pre></div></div>

<p>we will see that there is two new task available under <code class="language-plaintext highlighter-rouge">Verification tasks</code></p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gh">Verification tasks
------------------
</span>check - Runs all checks.
jacocoTestCoverageVerification - Verifies code coverage metrics based on specified rules for the test task.
jacocoTestReport - Generates code coverage report for the test task.
test - Runs the unit tests.
</code></pre></div></div>

<p>now we can <code class="language-plaintext highlighter-rouge">create code coverage</code> report by running -</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gradle jacocoTestReport
</code></pre></div></div>

<p>but I want to create <strong>code coverage report</strong> when I run <code class="language-plaintext highlighter-rouge">gradle test</code> command which run all <code class="language-plaintext highlighter-rouge">tests</code> for the project. To do so edit your <code class="language-plaintext highlighter-rouge">gradle.build</code> file -</p>

<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">...</span>
<span class="c1">// create test coverage every time the test task is performed</span>
<span class="n">test</span><span class="o">.</span><span class="na">finalizedBy</span> <span class="n">jacocoTestReport</span>

</code></pre></div></div>

<p>Now run <code class="language-plaintext highlighter-rouge">gradle build</code> or <code class="language-plaintext highlighter-rouge">gradle test</code> to generate the <strong>Code Coverage Report</strong>. The <strong>Code Coverage Report</strong> can be found in <strong>build&gt;reports&gt;jacoco&gt;test&gt;html</strong>. Open the <code class="language-plaintext highlighter-rouge">index.html</code> file here to view the <strong>Coverage Report</strong></p>

<p><img width="100%" src="/assets/images/resized/20/jacocoReport.jpg" data-src="/assets/images/resized/800/jacocoReport.jpg" alt="" data-srcset="    /assets/images/resized/20/jacocoReport.jpg 20w,    /assets/images/resized/480/jacocoReport.jpg 480w,    /assets/images/resized/800/jacocoReport.jpg 800w," class="blur-up lazyautosizes lazyload " /></p>

<p class="notice--danger"><strong>Please Note:</strong> We can use <code class="language-plaintext highlighter-rouge">JaCoCo</code> to generate <code class="language-plaintext highlighter-rouge">Code Coverage Report</code> for <strong>Continuous Code Quality</strong> tools like <strong>SonarQube</strong><sup id="fnref:2"><a href="#fn:2" class="footnote" rel="footnote" role="doc-noteref">2</a></sup>. I will discuss about it in future articles.</p>

<h2 id="references">References:</h2>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1">
      <p><a href="http://www.eclemma.org/jacoco/">JaCoCo</a> is a free code coverage library for Java, which has been created by the EclEmma team based on the lessons learned from using and integration existing libraries for many years. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2">
      <p><a href="https://www.sonarqube.org/">SonarQube</a> - <code class="language-plaintext highlighter-rouge">SonarQube</code> is an open source platform for continuous inspection of code quality to perform automatic reviews with static analysis of code to detect bugs, code smells and security vulnerabilities on 20+ Programming languages. SonarQube offers reports on duplicated code, coding standards, unit tests, code coverage, code complexity, comments, bugs, and security vulnerabilities. SonarQube can record metrics history and provides evolution graphs. SonarQube’s greatest asset is that it provides fully automated analysis and integration with Maven, Ant, Gradle, MSBuild and continuous integration tools. SonarQube also integrates with Eclipse, Visual Studio and IntelliJ IDEA development environments through the SonarLint plugins and integrates with external tools like LDAP, Active Directory, GitHub, etc. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name>Ratan Sunder Parai</name><email>contact@ratanparai.com</email></author><category term="Java" /><category term="gradle" /><category term="junit" /><category term="code coverage" /><category term="jacoco" /><category term="unit test" /><summary type="html"><![CDATA[Although we can use IDE for creating new java projects, if we use a build tool like `gradle` and create the project from ground up then not only we have more control, we can also change between IDEs as we feel the need.]]></summary></entry><entry><title type="html">Responsive image on jekyll</title><link href="https://www.ratanparai.com/jekyll/Responsive-image-on-jekyll/" rel="alternate" type="text/html" title="Responsive image on jekyll" /><published>2017-11-24T04:52:00+00:00</published><updated>2017-11-24T04:52:00+00:00</updated><id>https://www.ratanparai.com/jekyll/Responsive-image-on-jekyll</id><content type="html" xml:base="https://www.ratanparai.com/jekyll/Responsive-image-on-jekyll/"><![CDATA[<p>Responsive image make your website faster by loading the image that is required for the screen. Loading high quality image in every screen size is not optimal. Also showing a low quality blur version of the image while the real image is loading also improve the readability.</p>
<h2 id="installation">Installation</h2>
<h3 id="jekyll-responsive-image-plugin">jekyll-responsive-image plugin</h3>
<p>First, add -</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gem</span> <span class="s1">'jekyll-responsive-image'</span>
</code></pre></div></div>

<p>to your <code class="language-plaintext highlighter-rouge">Gemfile</code>.</p>

<p>Then add it to the <code class="language-plaintext highlighter-rouge">plugins</code> section of your <code class="language-plaintext highlighter-rouge">_config.yml</code>:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">...</span>
<span class="ss">plugins:
  </span><span class="o">-</span> <span class="n">jekyll</span><span class="o">-</span><span class="n">paginate</span>
  <span class="o">-</span> <span class="n">jekyll</span><span class="o">-</span><span class="n">sitemap</span>
  <span class="o">-</span> <span class="n">jekyll</span><span class="o">-</span><span class="n">gist</span>
  <span class="o">-</span> <span class="n">jekyll</span><span class="o">-</span><span class="n">feed</span>
  <span class="o">-</span> <span class="n">jemoji</span>
  <span class="o">-</span> <span class="n">jekyll</span><span class="o">-</span><span class="n">archives</span>
  <span class="o">-</span> <span class="n">jekyll</span><span class="o">-</span><span class="n">responsive</span><span class="o">-</span><span class="n">image</span>
<span class="o">...</span>
</code></pre></div></div>

<p>Last, install the plugin by running</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bundle <span class="nb">install</span>
</code></pre></div></div>

<p class="notice--danger"><strong>Please Note:</strong> If there is an error while installing the plugin plese run <code class="language-plaintext highlighter-rouge">sudo apt-get install libmagickwand-dev</code> to install required library and try again. And if you are on windows follow this step <a href="https://medium.com/ruby-on-rails-web-application-development/install-rmagick-gem-on-windows-7-8-10-imagemagick-6-9-4-q16-hdri-5492c3fef202">How To Install The RMagick #RubyOnRails Gem on Windows 7 / 8 / 10 (ImageMagick 6.9.4 Q16-HDRI)</a></p>

<h2 id="configuration">Configuration</h2>
<h3 id="_configyml-file">_config.yml file</h3>
<p>Add those lines to the end of your <code class="language-plaintext highlighter-rouge">_config.yml</code> file-</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Responsive images</span>
<span class="na">responsive_image</span><span class="pi">:</span>
  <span class="c1"># [Required]</span>
  <span class="c1"># Path to the image template.</span>
  <span class="na">template</span><span class="pi">:</span> <span class="s">_includes/responsive-image.html</span>

  <span class="c1"># [Optional, Default: 85]</span>
  <span class="c1"># Quality to use when resizing images.</span>
  <span class="na">default_quality</span><span class="pi">:</span> <span class="m">90</span>

  <span class="c1"># [Optional, Default: []]</span>
  <span class="c1"># An array of resize configuration objects. Each object must contain at least</span>
  <span class="c1"># a `width` value.</span>
  <span class="na">sizes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">width</span><span class="pi">:</span> <span class="m">20</span> <span class="c1"># lq</span>
      <span class="na">quality</span><span class="pi">:</span> <span class="m">10</span>
    <span class="pi">-</span> <span class="na">width</span><span class="pi">:</span> <span class="m">480</span>  <span class="c1"># [Required] How wide the resized image will be.</span>
      <span class="na">quality</span><span class="pi">:</span> <span class="m">80</span> <span class="c1"># [Optional] Overrides default_quality for this size.</span>
    <span class="pi">-</span> <span class="na">width</span><span class="pi">:</span> <span class="m">800</span>
    <span class="pi">-</span> <span class="na">width</span><span class="pi">:</span> <span class="m">1400</span>
      <span class="na">quality</span><span class="pi">:</span> <span class="m">90</span>

  <span class="c1"># [Optional, Default: false]</span>
  <span class="c1"># Rotate resized images depending on their EXIF rotation attribute. Useful for</span>
  <span class="c1"># working with JPGs directly from digital cameras and smartphones</span>
  <span class="na">auto_rotate</span><span class="pi">:</span> <span class="no">false</span>

  <span class="c1"># [Optional, Default: assets]</span>
  <span class="c1"># The base directory where assets are stored. This is used to determine the</span>
  <span class="c1"># `dirname` value in `output_path_format` below.</span>
  <span class="na">base_path</span><span class="pi">:</span> <span class="s">assets/images</span>

  <span class="c1"># [Optional, Default: assets/resized/%{filename}-%{width}x%{height}.%{extension}]</span>
  <span class="c1"># The template used when generating filenames for resized images. Must be a</span>
  <span class="c1"># relative path.</span>
  <span class="c1">#</span>
  <span class="c1"># Parameters available are:</span>
  <span class="c1">#   %{dirname}     Directory of the file relative to `base_path` (assets/sub/dir/some-file.jpg =&gt; sub/dir)</span>
  <span class="c1">#   %{basename}    Basename of the file (assets/some-file.jpg =&gt; some-file.jpg)</span>
  <span class="c1">#   %{filename}    Basename without the extension (assets/some-file.jpg =&gt; some-file)</span>
  <span class="c1">#   %{extension}   Extension of the file (assets/some-file.jpg =&gt; jpg)</span>
  <span class="c1">#   %{width}       Width of the resized image</span>
  <span class="c1">#   %{height}      Height of the resized image</span>
  <span class="c1">#</span>
  <span class="na">output_path_format</span><span class="pi">:</span> <span class="s">assets/images/resized/%{width}/%{basename}</span>

  <span class="c1"># [Optional, Default: true]</span>
  <span class="c1"># Whether or not to save the generated assets into the source folder.</span>
  <span class="na">save_to_source</span><span class="pi">:</span> <span class="no">false</span>

  <span class="c1"># [Optional, Default: false]</span>
  <span class="c1"># Cache the result of {% responsive_image %} and {% responsive_image_block %} </span>
  <span class="c1"># tags. See the "Caching" section of the README for more information.</span>
  <span class="na">cache</span><span class="pi">:</span> <span class="no">false</span>

  <span class="c1">#/ [Optional, Default: []]</span>
  <span class="c1"># By default, only images referenced by the responsive_image and responsive_image_block</span>
  <span class="c1"># tags are resized. Here you can set a list of paths or path globs to resize other</span>
  <span class="c1"># images. This is useful for resizing images which will be referenced from stylesheets.</span>
  <span class="na">extra_images</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">assets/foo/bar.png</span>
    <span class="pi">-</span> <span class="s">assets/bgs/*.png</span>
    <span class="pi">-</span> <span class="s">assets/avatars/*.{jpeg,jpg}</span>

</code></pre></div></div>
<h3 id="create-image-template">Create image template</h3>
<p>Now create a <code class="language-plaintext highlighter-rouge">responsive-image.html</code> template file and paste the contents there-</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{% capture srcset %}
{% for i in resized %}
    /{{ i.path }} {{ i.width }}w,
{% endfor %}
{% endcapture %}

{% assign smallest = resized | sort: 'width' | first %}

<span class="nt">&lt;img</span> <span class="na">width=</span><span class="s">"100%"</span> <span class="na">src=</span><span class="s">"/{{ smallest.path }}"</span> <span class="na">alt=</span><span class="s">"{{ alt }}"</span> <span class="na">data-srcset=</span><span class="s">"{{ srcset | strip_newlines }}"</span> <span class="na">class=</span><span class="s">"blur-up lazyautosizes lazyload"</span><span class="nt">&gt;</span> 
</code></pre></div></div>

<h3 id="add-lazysizes">Add lazysizes</h3>
<p>You need to add lazysizes js file to your website. To do this, download the <code class="language-plaintext highlighter-rouge">min</code> version from <a href="https://github.com/aFarkas/lazysizes">here</a> and put it to your <code class="language-plaintext highlighter-rouge">assets/js</code> folder and add those line to your <code class="language-plaintext highlighter-rouge">script</code> section depending on your theme.</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"{{ '/assets/js/lazysizes.min.js'| absolute_url }}"</span><span class="nt">&gt;&lt;/script&gt;</span> 
</code></pre></div></div>

<p class="notice--danger"><strong>Please Note:</strong> I am using <a href="https://github.com/mmistakes/minimal-mistakes"><code class="language-plaintext highlighter-rouge">minimal mistake</code></a> theme. So I added the <code class="language-plaintext highlighter-rouge">js</code> file in <code class="language-plaintext highlighter-rouge">_includes&gt;scripts.html</code> after the <code class="language-plaintext highlighter-rouge">main.min.js</code> include code</p>

<h3 id="css-modification">CSS modification</h3>
<p>Now add those line to your css file for blur effect for smoth image pixel</p>

<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">.no-js</span> <span class="nt">img</span><span class="nc">.lazyload</span> <span class="p">{</span>
<span class="nl">display</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.blur-up</span> <span class="p">{</span>
<span class="nl">filter</span><span class="p">:</span> <span class="nf">blur</span><span class="p">(</span><span class="m">10px</span><span class="p">);</span>
<span class="nl">transition</span><span class="p">:</span> <span class="n">filter</span> <span class="m">400ms</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.blur-up.lazyloaded</span> <span class="p">{</span>
<span class="nl">filter</span><span class="p">:</span> <span class="nf">blur</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="nc">.fade-in</span> <span class="p">{</span>
<span class="nl">opacity</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
<span class="nl">transition</span><span class="p">:</span> <span class="n">opacity</span> <span class="m">400ms</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.fade-in.lazyloaded</span> <span class="p">{</span>
<span class="nl">opacity</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="how-to-use">How to use</h2>
<p>To insert image in a post use</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code> {% responsive_image path: assets/images/Rio.jpg %} 
</code></pre></div></div>

<p>where  <code class="language-plaintext highlighter-rouge">assets/images/Rio.jpg</code> is your image path. This will take care of everything. Now you can enjoy responsive image in your blog.</p>

<h2 id="testing">Testing</h2>
<p>Here is a normal image-
<img src="/assets/images/Rio.jpg" alt="rio" /></p>

<p>and here is a responsive image with lazy loading enabled</p>

<p><img width="100%" src="/assets/images/resized/20/Rio.jpg" data-src="/assets/images/resized/800/Rio.jpg" alt="" data-srcset="    /assets/images/resized/20/Rio.jpg 20w,    /assets/images/resized/480/Rio.jpg 480w,    /assets/images/resized/800/Rio.jpg 800w,    /assets/images/resized/1400/Rio.jpg 1400w," class="blur-up lazyautosizes lazyload " /></p>

<p class="notice--danger"><strong>Please Note:</strong> This may not work with <code class="language-plaintext highlighter-rouge">Github Pages</code> directly. You need to host your own jekyll site or use third party CI tool to build the site. I am using <a href="https://travis-ci.com/">Travis ci</a> for my blog. If you have any question feel free to ask me.</p>]]></content><author><name>Ratan Sunder Parai</name><email>contact@ratanparai.com</email></author><category term="Jekyll" /><category term="responsive image" /><category term="jekyll plugin" /><category term="lazysizes" /><summary type="html"><![CDATA[Responsive image make your website faster by loading the image that is required for the screen. Loading high quality image in every screen size is not optimal. Also showing a low quality blur version of the image while the real image is loading also improve the readability. Installation jekyll-responsive-image plugin First, add -]]></summary></entry><entry><title type="html">Change ssh port of CentOS 7</title><link href="https://www.ratanparai.com/linux/change-centos7-ssh-port/" rel="alternate" type="text/html" title="Change ssh port of CentOS 7" /><published>2017-11-07T18:32:00+00:00</published><updated>2017-11-07T18:32:00+00:00</updated><id>https://www.ratanparai.com/linux/change-centos7-ssh-port</id><content type="html" xml:base="https://www.ratanparai.com/linux/change-centos7-ssh-port/"><![CDATA[<p>To change SSH port of CentOS 7 please follow those steps-</p>

<ol>
  <li>At first backup the default configuration file. It is always a best practice to backup files before modification, so that we can restore it if anything unwanted happends.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo cp</span> /etc/ssh/sshd_config /etc/ssh/sshd_config.bak
</code></pre></div>    </div>
  </li>
  <li>Then open the <code class="language-plaintext highlighter-rouge">sshd_config</code> file -
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>vi /etc/ssh/sshd_config
</code></pre></div>    </div>
    <p>and change the port number(ex. 2122) -</p>
    <div class="language-config highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Port</span> <span class="m">2122</span>
<span class="c">#AddressFamily any
#ListenAddress 0.0.0.0
#ListenAddress ::
</span></code></pre></div>    </div>
  </li>
  <li>By default, SELinux only allows port 22 for SSH. What you need to do is enable the newly created port through SELinux. To do that, run the commands below
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>semanage port <span class="nt">-a</span> <span class="nt">-t</span> ssh_port_t <span class="nt">-p</span> tcp 2122
</code></pre></div>    </div>
  </li>
  <li>Add the new port to the firewall to allow access
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>firewall-cmd <span class="nt">--permanent</span> <span class="nt">--zone</span><span class="o">=</span>public <span class="nt">--add-port</span><span class="o">=</span>2122/tcp
</code></pre></div>    </div>
  </li>
  <li>Reload the firewall configuration file -
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>firewall-cmd <span class="nt">--reload</span>
</code></pre></div>    </div>
  </li>
  <li>Now restart SSH service
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl restart sshd.service
</code></pre></div>    </div>
  </li>
  <li>Now exit and try to connect to new port
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh username@192.168.10.240 <span class="nt">-p</span> 2022
</code></pre></div>    </div>
  </li>
</ol>

<p>Enjoy</p>]]></content><author><name>Ratan Sunder Parai</name><email>contact@ratanparai.com</email></author><category term="Linux" /><category term="CentOS 7" /><category term="SSH" /><summary type="html"><![CDATA[Change ssh port of CentOS 7]]></summary></entry></feed>